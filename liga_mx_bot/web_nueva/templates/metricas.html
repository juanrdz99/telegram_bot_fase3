{% extends "base.html" %}

{% block title %}Métricas de Liga MX - Tabla de Posiciones y Estadísticas{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/metricas.css') }}">
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
{% endblock %}

{% block content %}
<div class="metrics-container">
    <div class="section-header">
        <h1>Métricas y Estadísticas Liga MX</h1>
        <button id="refresh-data" class="refresh-btn">
            <i class="fas fa-sync-alt"></i> Actualizar Datos
        </button>
    </div>
    
    <div class="update-info">
        <span id="last-update" class="last-update">Última actualización: Cargando...</span>
    </div>
    
    <!-- Tabla de Posiciones -->
    <div class="metrics-section">
        <h2>Tabla de Posiciones</h2>
        <div id="standings-loading" class="loading-indicator">
            <i class="fas fa-spinner fa-spin fa-2x"></i>
        </div>
        <div id="standings-container" style="display: none;">
            <table class="standings-table">
                <thead>
                    <tr>
                        <th>Pos</th>
                        <th>Equipo</th>
                        <th>PJ</th>
                        <th>PG</th>
                        <th>PE</th>
                        <th>PP</th>
                        <th>GF</th>
                        <th>GC</th>
                        <th>DG</th>
                        <th>Pts</th>
                    </tr>
                </thead>
                <tbody id="standings-body"></tbody>
            </table>
        </div>
    </div>
    
    <!-- Estadísticas -->
    <div class="metrics-section">
        <h2>Estadísticas</h2>
        <div class="stats-container">
            <!-- Goleadores -->
            <div class="stats-card">
                <h3>Goleadores</h3>
                <div id="scorers-loading" class="loading-indicator">
                    <i class="fas fa-spinner fa-spin"></i>
                </div>
                <ul id="scorers-list" class="scorers-list" style="display: none;"></ul>
            </div>
            
            <!-- Gráfico de Goles -->
            <div class="stats-card">
                <h3>Goles por Equipo</h3>
                <div class="chart-container">
                    <canvas id="goals-chart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="stats-container">
            <!-- Tarjetas -->
            <div class="stats-card">
                <h3>Tarjetas</h3>
                <div id="cards-loading" class="loading-indicator">
                    <i class="fas fa-spinner fa-spin"></i>
                </div>
                <div id="cards-container" style="display: none;">
                    <h4>Tarjetas Amarillas</h4>
                    <ul id="yellow-cards-list" class="cards-list"></ul>
                    
                    <h4>Tarjetas Rojas</h4>
                    <ul id="red-cards-list" class="cards-list"></ul>
                </div>
            </div>
            
            <!-- Gráfico de Tarjetas -->
            <div class="stats-card">
                <h3>Tarjetas por Equipo</h3>
                <div class="chart-container">
                    <canvas id="cards-chart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Faltas -->
        <div class="stats-container">
            <div class="stats-card">
                <h3>Faltas por Equipo</h3>
                <div class="chart-container">
                    <canvas id="fouls-chart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/metricas.js') }}"></script>
{% endblock %}
